{"version":3,"sources":["tools/ModuleVersion.js"],"names":["createModuleVersionChecker","name","currentVersion","UpdateCacher","Cacher","async","pkgJson","await","npmPackageJson","version","latestVersion","pTimeout","latestVersionAsync","deprecated","checkAsync","getAsync","updateIsAvailable","semver","gt","latest","current"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEA;;;;AAEA,SAASA,0BAAT,CAAoCC,IAApC,EAA0CC,cAA1C,EAA0D;AACxD,QAAMC,YAAAA,GAAe,IAAIC,eAAJ,CACnBC,YAAY;AACV,UAAMC,OAAAA,GAAUC,MAAMC,0BAAeP,IAAfO,EAAqB;AAAEC,MAAAA,OAAO,EAAEP;AAAX,KAArBM,CAAtB;AACA,WAAO;AACLE,MAAAA,aAAa,EAAEH,MAAMI,uBAASC,4BAAmBX,IAAnBW,CAATD,EAAmC,IAAnCA,CADhB;AAELE,MAAAA,UAAU,EAAEP,OAAO,CAACO;AAFf,KAAP;AAID,GAPkB,EAQlB,GAAEZ,IAAK,eARW,EASnB,KAAK,EAAL,GAAU,EAAV,GAAe,IATI,CASJ;AATI,GAArB;;AAYAI,iBAAeS,UAAfT,GAA4B;AAC1B,UAAM;AAAEK,MAAAA,aAAF;AAAiBG,MAAAA;AAAjB,QAAgCN,MAAMJ,YAAY,CAACY,QAAbZ,EAA5C;AACA,WAAO;AACLa,MAAAA,iBAAiB,EAAEC,gBAAOC,EAAPD,CAAUP,aAAVO,EAAyBf,cAAzBe,CADd;AAELE,MAAAA,MAAM,EAAET,aAFH;AAGLU,MAAAA,OAAO,EAAElB,cAHJ;AAILW,MAAAA;AAJK,KAAP;AAMF;;AAEA,SAAO;AAAEC,IAAAA;AAAF,GAAP;AACF","file":"../../tools/ModuleVersion.js","sourcesContent":["import latestVersionAsync from 'latest-version';\nimport npmPackageJson from 'package-json';\nimport pTimeout from 'p-timeout';\nimport semver from 'semver';\n\nimport { Cacher } from './FsCache';\n\nfunction createModuleVersionChecker(name, currentVersion) {\n  const UpdateCacher = new Cacher(\n    async () => {\n      const pkgJson = await npmPackageJson(name, { version: currentVersion });\n      return {\n        latestVersion: await pTimeout(latestVersionAsync(name), 2000),\n        deprecated: pkgJson.deprecated,\n      };\n    },\n    `${name}-updates.json`,\n    24 * 60 * 60 * 1000 // one day\n  );\n\n  async function checkAsync() {\n    const { latestVersion, deprecated } = await UpdateCacher.getAsync();\n    return {\n      updateIsAvailable: semver.gt(latestVersion, currentVersion),\n      latest: latestVersion,\n      current: currentVersion,\n      deprecated,\n    };\n  }\n\n  return { checkAsync };\n}\n\nexport { createModuleVersionChecker };\n"],"sourceRoot":"/@expo/xdl@55.0.14/src"}