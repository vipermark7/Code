{"version":3,"sources":["tools/ModuleVersion.js"],"names":["createModuleVersionChecker","name","currentVersion","async","latestVersion","await","UpdateCacher","getAsync","updateIsAvailable","semver","gt","latest","current","checkAsync","pTimeout","latestVersionAsync"],"mappings":";;;;;;;;;AAAA;AAAA;AAAA;;;;AACA;AAAA;AAAA;;;;AACA;AAAA;AAAA;;;;AAEA;AAAA;AAAA;;;;;;AAEA,SAASA,0BAAT,CAAoCC,IAApC,EAA0CC,cAA1C,EAA0D;AAAA;AAAA,kCASxDC,aAA4B;AAC1B,YAAM,EAAEC,aAAF,KAAoBC,MAAMC,aAAaC,QAAbD,EAAhC;AACA,aAAO;AACLE,2BAAmBC,oCAAOC,EAAPD,CAAUL,aAAVK,EAAyBP,cAAzBO,CADd;AAELE,gBAAQP,aAFH;AAGLQ,iBAASV;AAHJ,OAAP;AAKF,KAhBwD;;AAAA,oBASzCW,UATyC;AAAA;AAAA;AAAA;;AACxD,QAAMP,eAAe,2DACnBH,aAAY;AACV,WAAO,EAAEC,eAAeC,MAAMS,6CAASC,uDAAmBd,IAAnBc,CAATD,EAAmC,IAAnCA,CAAvB,EAAP;AACD,GAHkB,GAIlB,GAAEb,IAAK,eAJW,EAKnB,KAAK,EAAL,GAAU,EAAV,GAAe,IALI,CAKJ;AALI,GAArB;;AAiBA,SAAO,EAAEY,UAAF,EAAP;AACF;;QAESb,0B,GAAAA,0B","file":"../../tools/ModuleVersion.js","sourcesContent":["import latestVersionAsync from 'latest-version';\nimport pTimeout from 'p-timeout';\nimport semver from 'semver';\n\nimport { Cacher } from './FsCache';\n\nfunction createModuleVersionChecker(name, currentVersion) {\n  const UpdateCacher = new Cacher(\n    async () => {\n      return { latestVersion: await pTimeout(latestVersionAsync(name), 2000) };\n    },\n    `${name}-updates.json`,\n    24 * 60 * 60 * 1000 // one day\n  );\n\n  async function checkAsync() {\n    const { latestVersion } = await UpdateCacher.getAsync();\n    return {\n      updateIsAvailable: semver.gt(latestVersion, currentVersion),\n      latest: latestVersion,\n      current: currentVersion,\n    };\n  }\n\n  return { checkAsync };\n}\n\nexport { createModuleVersionChecker };\n"],"sourceRoot":"/xdl@52.0.12/src"}